{% extends 'base.html.twig' %}

{% block title %}
		<h1 class='col-10'> DOSSIERS T </h1>
		<a href="{{path('acceuil')}}">
		<i class="fas fa-home fa-2x"></i></a>
{% endblock %}


{% block body %}
	<!-- *****	Barre de menu **** -->
	<div class='fixe'>
		<div class="menu cadre">
			<div class='d-flex'>
				<button class="btn btn-primary btn-sm" type="button" data-toggle="collapse" data-target="#ajouter" aria-expanded="false" aria-controls="ajouter">
					Ajouter
				</button>
				<a href='{{path('oldfile')}}' type='button' class='btn btn-primary btn-sm ml-3'>Ancien dossier</a>
				<div class="ml-auto">
					{{ form_start(formsearch)}}
					<div class="form-inline">
						<button type="submit" class="btn btn-success btn-sm mr-2">Recherche</button>
						{{form_widget(formsearch.searchin)}}
						{{ form_widget(formsearch.infield)}}
					</div>	
					{{ form_end(formsearch) }}
				</div>
			</div>
			<!-- ***** Formulaire d'ajout **** -->
			<div class="collapse formul" id="ajouter">
				<div class="mt-2 card card-body">
					{{ form_start(form) }}
						<div class="form-row">
							<div class="form-group col-1">
								{{form_widget(form.numdossier)}}
								<small class="invalid-feedback">{{form_errors(form.numdossier)}}</small>
							</div>
							<div class="form-group col-2">
								{{form_widget(form.client)}}
							</div>
							<div class="form-group col-4">
								{{form_widget(form.refpiece)}}
							</div>
							<div class="form-group col-1">
								{{form_widget(form.ind)}}
							</div>
							<div class="form-group col-4">
								{{form_widget(form.desigpiece)}}
							</div>
						</div>
						<div class='form-row'>
							<div class="custom-file col-5">
								{{form_widget(form.plan)}}
								<label class="custom-file-label labelplan" data-browse='Choisir'>Fichier PDF</label>
							</div>
						</div>
						<button type="submit" class="mt-3 btn btn-success">Valider !</button>
					{{ form_end(form)}}
				</div>
			</div>
		</div>
	</div>
	<!-- ***** tableau **** -->
	<div class='scroll-tab'>
		<div class="liste cadre">
			<table class="table table-striped table-sm ">
				<thead class="thead-dark">
					<tr>
						<th scope="col">Dossier 
							<a href="{{path('dossiert', {'try':'nu123'})}}" type='button' class='icon' data-toggle='tooltip' data-placement="top" title='Ordre croissant'>
								<i class="fas fa-caret-square-down"></i>
							</a>
							<a href="{{path('dossiert', {'try':'nu321'})}}" type='button' class='icon' data-toggle='tooltip' data-placement="top" title='Ordre décroissant'>
								<i class="fas fa-caret-square-up"></i>
							</a>
						</th>
						<th scope="col">Plan</th>
						<th scope="col">Client
							<a href=" {{path('dossiert', {'try':'cl123'} )}}" type='button' class='icon' data-toggle='tooltip' data-placement="top" title='Ordre croissant'>
								<i class="fas fa-caret-square-down"></i>
							</a>
							<a href=" {{path('dossiert', {'try':'cl321'} )}}" type='button' class='icon' data-toggle='tooltip' data-placement="top" title='Ordre décroissant'>
								<i class="fas fa-caret-square-up"></i>
							</a>
						</th>
						<th scope="col">Référence pièce</th>
						<th scope="col">Indice</th>
						<th scope="col">Désignation pièce</th>
						<th scope="col">Date de création
							<a href="{{path('dossiert', {'try':'dc123'})}}" type='button' class='icon' data-toggle='tooltip' data-placement="top" title='Ordre croissant'>
								<i class="fas fa-caret-square-down"></i>
							</a>
							<a href="{{path('dossiert', {'try':'dc321'})}}" type='button' class='icon' data-toggle='tooltip' data-placement="top" title='Ordre décroissant'>
								<i class="fas fa-caret-square-up"></i>
							</a>
						</th>
						<th scope="col">Actions</th>
					</tr>
				</thead>
				<tbody>
					{% for liste in listes %}
						<tr>
							<th scope="row">
								T{{ liste.numdossier}}
							</th>
							<td>
								{% if liste.plan %}
									<a href="{{asset('dossier/plan/' ~ liste.plan)}}" target='_blank' class='btn' type='button'>
										<i class="fas fa-drafting-compass fa-lg text-primary"></i>
									</a>
								{% endif %}
							</td>
							<td>{{ liste.client }}</td>
							<td>{{ liste.refpiece }}</td>
							<td>{{liste.ind}}</td>
							<td>{{ liste.desigpiece }}</td>
							<td>{{ liste.datecreat|date('d/m/Y') }}</td>
							<td>
								<a href="{{ path('update', {'id': liste.id}) }}" class="btn btn-sm">
									<i class="fas fa-pencil-alt fa-lg text-success"></i>
								</a>
								<a href="#" class="btn btn-sm" data-toggle="modal" data-target="#del{{liste.id}}" >
									<i class="fas fa-trash-alt fa-lg text-danger "></i>
								</a>
							</td>
						</tr>
						<!-- **** Modal suppression ligne **** -->
						<div class="modal fade" id="del{{liste.id}}" tabindex="-1" aria-labelledby="del" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-body">
										<h6>Suppression !!!</h6>
										<h6>Etes-vous sûr de vouloir supprimer le dossier N°
											T{{liste.numdossier}}
										</h6>
									</div>
									<div class="modal-footer">
										<button type="button" class="btn btn-success btn-sm" data-dismiss="modal">
											Annuler</button>
										<a href="{{ path('delete', {'id' : liste.id}) }}" type="button" class="btn btn-danger btn-sm">
											Supprimer !!</a>
									</div>
								</div>
							</div>
						</div>
					{% endfor %}
				</tbody>
			</table>
		</div>
	</div>
{% endblock %}
